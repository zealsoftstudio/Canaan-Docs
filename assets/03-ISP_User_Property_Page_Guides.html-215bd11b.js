import{_ as n,o as s,c as a,e}from"./app-21fd3c9b.js";const p={},t=e(`<h1 id="isp用户属性指南" tabindex="-1"><a class="header-anchor" href="#isp用户属性指南" aria-hidden="true">#</a> ISP用户属性指南</h1><h1 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h1><h2 id="property-page" tabindex="-1"><a class="header-anchor" href="#property-page" aria-hidden="true">#</a> Property Page</h2><p>类型说明</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">enum</span>  <span class="token class-name">isp_pipeline_e</span> <span class="token comment">//pipeline的索引号，通常以数字或成员名称表示不同的pipeline</span>
<span class="token punctuation">{</span>
    ISP_F2K_PIPELINE<span class="token punctuation">;</span> <span class="token comment">//对应int类型0</span>
    ISP_R2K_PIPELINE<span class="token punctuation">;</span> <span class="token comment">//对应int类型1</span>
    ISP_TOF_PIPELINE<span class="token punctuation">;</span> <span class="token comment">//对应int类型2</span>
<span class="token punctuation">}</span>；
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ADAPTIVE_USER_ATTR_ISP_CTL_T</span> <span class="token comment">//属性页ISP控制功能汇总结构体，修改成员值可以实现控制</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nLscEnable<span class="token punctuation">;</span> <span class="token comment">//控制LSC模块使能，0：关闭，1：开启</span>
    <span class="token keyword">int</span> nLdcEnable<span class="token punctuation">;</span> <span class="token comment">//控制LDC模块使能，0：关闭，1：开启。当前LDC不能打开ISP异常</span>
    <span class="token keyword">int</span> nAeEnable<span class="token punctuation">;</span> <span class="token comment">//控制自动/手动曝光，0：手动模式，1：自动模式。自动切换至手动状态默认使用上一帧曝光参数作为当前的手动值</span>
    <span class="token keyword">int</span> nAeEnhMode<span class="token punctuation">;</span> <span class="token comment">//控制背光补偿/强光抑制，0：关闭，1：背光补偿，2：强光抑制。与WDR功能冲突，仅有一种模式可以开启，当其他模式开启时，当前模式启动无效</span>
    <span class="token keyword">int</span> nWdrEnable<span class="token punctuation">;</span> <span class="token comment">// 0: normal, 1: linner-wdr enable。控制Linner WDR功能，与背光补偿和强光抑制功能冲突，仅有一种模式可以开启，当其他模式开启时，当前模式启动无效</span>
    <span class="token keyword">int</span> nAwbEnable<span class="token punctuation">;</span> <span class="token comment">//控制自动/手动白平衡，0：手动模式，1：自动模式。若模式为手动时可以选配不同光源的CCM及手动设置白平衡Rgain、Ggain、Bgain</span>
    <span class="token keyword">int</span> nFlip<span class="token punctuation">;</span> <span class="token comment">//控制镜像模式，0：正常，1：水平镜像，2：垂直镜像，3：水平垂直镜像</span>
    <span class="token keyword">int</span> nAntiflickerScl<span class="token punctuation">;</span> <span class="token comment">//控制工频闪烁抑制功能，0：关闭，1，2：50Hz自动/强制，3，4：60Hz自动/强制。强制模式时高亮场景将限制最小曝光时间只能达到1/100s(50Hz)或1/120s(60Hz)</span>
    <span class="token keyword">int</span> nDefogEn<span class="token punctuation">;</span> <span class="token comment">//控制去雾功能，0：关闭，1：开启</span>
    <span class="token keyword">int</span> reserved<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>ADAPTIVE_USER_ATTR_ISP_CTL_T<span class="token punctuation">;</span><span class="token comment">//通常初始化时用该别名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ADAPTIVE_USER_ATTR_LIMIT_T</span> <span class="token comment">//属性页限制参数范围汇总结构体</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nGainRange<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// gain range [0]: min, [1]: max</span>
    <span class="token keyword">int</span> nEtRange<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ET range [0]: min, [1]: max</span>
    <span class="token keyword">int</span> nCtScl<span class="token punctuation">;</span> <span class="token comment">// 选择不同光源下的CCM矩阵设置。0：A，1：U30，2：U35，3：TL84，4：D50，5：D65。AWB处于手动模式时，当前功能有效</span>
<span class="token punctuation">}</span>ADAPTIVE_USER_ATTR_LIMIT_T<span class="token punctuation">;</span> <span class="token comment">//通常初始化时用该别名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ADAPTIVE_USER_ATTR_WEIGHT_T</span> <span class="token comment">//属性页调整功能强度汇总结构体</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nSaturationCoeff<span class="token punctuation">;</span> <span class="token comment">//控制饱和度等级，范围0-100，默认50</span>
    <span class="token keyword">int</span> nBrightnessCoeff<span class="token punctuation">;</span> <span class="token comment">//控制亮度等级，范围0-100，默认50</span>
    <span class="token keyword">int</span> nContrastCoeff<span class="token punctuation">;</span> <span class="token comment">//控制对比度等级，范围0-100，默认50</span>
    <span class="token keyword">int</span> nSharpnessCoeff<span class="token punctuation">;</span> <span class="token comment">//控制锐度强度，范围0-100，默认50</span>
    <span class="token keyword">int</span> n2dnrLevelCoeff<span class="token punctuation">;</span> <span class="token comment">//控制2D降噪强度，范围0-10，默认5</span>
    <span class="token comment">/* ae param */</span>
    <span class="token keyword">int</span> nAeBacklightCoeff<span class="token punctuation">;</span> <span class="token comment">//控制背光补偿模式强度，自动曝光且开启背光补偿模式下，范围1-10，不与强光抑制同时生效</span>
    <span class="token keyword">int</span> nAeStronglightCoeff<span class="token punctuation">;</span> <span class="token comment">//控制强光抑制模式强度，自动曝光且开启强光抑制模式下，范围1-10，不与背光补偿同时生效</span>
    <span class="token keyword">int</span> nWdrCoeff<span class="token punctuation">;</span> <span class="token comment">//Linner WDR功能有效开启时，控制WDR强度，范围0-9，注意设置超过9图像将异常</span>
<span class="token punctuation">}</span>ADAPTIVE_USER_ATTR_WEIGHT_T<span class="token punctuation">;</span> <span class="token comment">//通常初始化时用该别名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ADAPTIVE_USER_MENU_3A_T</span> <span class="token comment">//属性页开启手动模式时可以控制的参数</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nCurGain<span class="token punctuation">;</span> <span class="token comment">// current gain: 1~16x, default 2x, over range will use min or max value</span>
    <span class="token keyword">int</span> <span class="token keyword">float</span> nCurExpTime<span class="token punctuation">;</span> <span class="token comment">// current exposure time(us)</span>
    <span class="token keyword">int</span> nCurWbRGain<span class="token punctuation">;</span> <span class="token comment">//手动白平衡下，控制红通道增益，范围0-1023，默认202</span>
    <span class="token keyword">int</span> nCurWbGGain<span class="token punctuation">;</span> <span class="token comment">//手动白平衡下，控制绿通道增益，范围0-1023，默认256不动</span>
    <span class="token keyword">int</span> nCurWbBGain<span class="token punctuation">;</span> <span class="token comment">//手动白平衡下，控制蓝通道增益，范围0-1023，默认356</span>
<span class="token punctuation">}</span>ADAPTIVE_USER_MENU_3A_T<span class="token punctuation">;</span> <span class="token comment">//通常初始化时用该别名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ADAP_USER_ATTR_PAGE_T</span> <span class="token comment">//属性页控制汇总结构体</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nWritten<span class="token punctuation">;</span> <span class="token comment">//写入状态，下发时默认置为2，其他值将无法下发</span>
    <span class="token keyword">int</span> nAdaptiveUserAttrEnable<span class="token punctuation">;</span> <span class="token comment">//属性页使能，0：关闭属性页功能，1：开启属性页功能</span>
    <span class="token keyword">int</span> nAdaptiveUserAeMode<span class="token punctuation">;</span> <span class="token comment">// only use to ae auto/handle switch 0: sw, 1: hw</span>
    <span class="token keyword">int</span> nAeSync<span class="token punctuation">;</span> <span class="token comment">// only use for ae sync in dual camera &amp; sw ae</span>
    ADAPTIVE_USER_ATTR_ISP_CTL_T tUserAttrIspCtl<span class="token punctuation">;</span> <span class="token comment">//ISP控制功能，上述结构体</span>
    ADAPTIVE_USER_ATTR_LIMIT_T tUserAttrLimit<span class="token punctuation">;</span> <span class="token comment">//限制参数范围，上述结构体</span>
    ADAPTIVE_USER_ATTR_WEIGHT_T tUserAttrWeight<span class="token punctuation">;</span> <span class="token comment">//调整功能强度，上述结构体</span>
    ADAPTIVE_USER_MENU_3A_T tUserMenu3A<span class="token punctuation">;</span> <span class="token comment">//手动模式下控制参数，上述结构体</span>
<span class="token punctuation">}</span>ADAPTIVE_ATTRIBUTE_PAGE_T<span class="token punctuation">;</span> <span class="token comment">// Root Permission for whole adaptive function</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>函数</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">attr_page_params_setting</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> ADAPTIVE_ATTRIBUTE_PAGE_T <span class="token operator">*</span> attr_page<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//属性页功能设置，传入参数pipeline 0：f2k, 1：r2k，3：tof（不支持），attr_page为上述汇总结构体指针，即可控制</span>
<span class="token keyword">int</span> <span class="token function">attr_page_get_written_stat</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取可写状态，返回3，可进行配置</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="face-ae" tabindex="-1"><a class="header-anchor" href="#face-ae" aria-hidden="true">#</a> Face Ae</h2><p>类型说明</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">enum</span> <span class="token class-name">ae_hist_mode_e</span>
<span class="token punctuation">{</span>
    AE_HIST_MODE_WHOLE_PICTURE<span class="token punctuation">,</span> <span class="token comment">// 全图统计</span>
    AE_HIST_MODE_CENTRAL_AERA<span class="token punctuation">,</span> <span class="token comment">// 窗口统计</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// AE统计模式</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">__AE_HIST_WINDOW_T</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nHStart<span class="token punctuation">;</span>
    <span class="token keyword">int</span> nVStart<span class="token punctuation">;</span>
    <span class="token keyword">int</span> nHEnd<span class="token punctuation">;</span> 
    <span class="token keyword">int</span> nVEnd<span class="token punctuation">;</span>
<span class="token punctuation">}</span> AE_HIST_WINDOW_T<span class="token punctuation">;</span> <span class="token comment">//AE统计窗口</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>函数</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">ae_hist_mode_scl</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">ae_hist_mode_e</span> ae_hist_mode<span class="token punctuation">,</span> AE_HIST_WINDOW_T <span class="token operator">*</span> hist_window<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// AE统计模式选择</span>

<span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token operator">:</span> 选择pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> f2k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> r2k
<span class="token keyword">enum</span> <span class="token class-name">ae_hist_mode_e</span> ae_hist_mode<span class="token operator">:</span> 选择AE模式
AE_HIST_WINDOW_T <span class="token operator">*</span> hist_window<span class="token operator">:</span> AE统计窗口的结构体指针（通过人脸识别后赋值），仅在窗口统计模式下可用，全图统计模式下默认为<span class="token constant">NULL</span>即可

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Demo</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;media_ctl.h&quot;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    AE_HIST_WINDOW_T <span class="token operator">*</span> hist_window<span class="token punctuation">;</span> <span class="token comment">// 初始化人脸坐标结构体</span>
    hist_window<span class="token operator">-&gt;</span>nHStart <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// 从KPU AIdemo获取主人脸识别坐标</span>
    hist_window<span class="token operator">-&gt;</span>nVStart <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token comment">// 同上</span>
    hist_window<span class="token operator">-&gt;</span>nHEnd <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span> <span class="token comment">// 同上</span>
    hist_window<span class="token operator">-&gt;</span>nVEnd <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span> <span class="token comment">// 同上</span>
    <span class="token function">ae_hist_mode_scl</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> AE_HIST_MODE_CENTRAL_AERA<span class="token punctuation">,</span> <span class="token operator">&amp;</span>hist_window<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用face ae设置模式将人脸坐标作为统计窗口使用</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="y-average-get" tabindex="-1"><a class="header-anchor" href="#y-average-get" aria-hidden="true">#</a> Y Average Get</h2><p>类型说明</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">enum</span>  <span class="token class-name">isp_pipeline_e</span>
<span class="token punctuation">{</span>
    ISP_F2K_PIPELINE<span class="token punctuation">,</span>
    ISP_R2K_PIPELINE<span class="token punctuation">,</span>
    ISP_TOF_PIPELINE<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>函数</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">ae_y_average_get</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>value<span class="token operator">:</span> 指向<span class="token keyword">unsigned</span> <span class="token keyword">int</span>的指针，传入后将被赋值亮度统计值
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Demo</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;media_ctl.h&quot;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    ret <span class="token operator">=</span> <span class="token function">ae_y_average_get</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token operator">&amp;</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;y average after get: %d\\n&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ir-cut" tabindex="-1"><a class="header-anchor" href="#ir-cut" aria-hidden="true">#</a> Ir Cut</h2><p>类型说明</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span>
<span class="token punctuation">{</span>
    USER_IR_CUT_NIGHT<span class="token punctuation">,</span> <span class="token comment">// 夜片模式</span>
    USER_IR_CUT_DAY<span class="token punctuation">,</span> <span class="token comment">// 日片模式</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Ir Cut模式</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">__CB_IR_CUT_T</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> nIrCutCtl<span class="token punctuation">;</span> <span class="token comment">// 0:day2night, 1: night2day</span>
    <span class="token keyword">int</span> nSensor<span class="token punctuation">;</span> <span class="token comment">// 0: sensor0, 1: sensor1</span>
<span class="token punctuation">}</span> CB_IR_CUT_T<span class="token punctuation">;</span> <span class="token comment">// 用户回调函数使用的参数结构体</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span> __IspCallBack<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 回调函数形式定义</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">__ISP_CB_T</span>
<span class="token punctuation">{</span>
    __IspCallBack pIspfunc<span class="token punctuation">;</span> <span class="token comment">// 用户回调函数指针</span>
    <span class="token keyword">int</span> nSize<span class="token punctuation">;</span> <span class="token comment">// 用户回调函数传入参数的长度</span>
    <span class="token keyword">enum</span> <span class="token class-name">isp_callback_id</span> nIcbId<span class="token punctuation">;</span> <span class="token comment">// 回调函数注册模块ID</span>
<span class="token punctuation">}</span> ISP_CB_T<span class="token punctuation">;</span> <span class="token comment">// 用户注册函数用的结构体</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>函数</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">isp_module_callback_register</span><span class="token punctuation">(</span>ISP_CB_T <span class="token operator">*</span> icb<span class="token punctuation">)</span><span class="token punctuation">;</span>
回调函数注册接口
ISP_CB_T <span class="token operator">*</span> icb<span class="token operator">:</span> 注册用的结构体指针，避免使用临时指针
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">ir_cut_ev_get</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
获取切换日<span class="token operator">/</span>夜片的曝光量阈值等级
<span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token operator">:</span> 选择pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> f2k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> r2k
<span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token operator">:</span> 获取切换日片模式的曝光量等级表示当前曝光量小于该等级时切换日片，获取切换夜片模式的曝光量等级表示当曝光量大于该等级时切换夜片
返回值<span class="token operator">:</span> 曝光量等级<span class="token number">1</span><span class="token operator">-</span><span class="token number">10</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">ir_cut_ev_set</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span><span class="token punctuation">;</span>
设置切换日<span class="token operator">/</span>夜片的曝光量阈值等级
<span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token operator">:</span> 选择pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> f2k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> r2k
<span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token operator">:</span> 日片模式时设置的曝光量等级表示当前曝光量小于该等级时切换日片，夜片模式时设置的曝光量等级表示当前曝光量大于该等级时切换夜片
返回值<span class="token operator">:</span> <span class="token number">0</span>为成功，非<span class="token number">0</span>为失败
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">float</span> <span class="token function">ir_cut_hold_time_get</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
获取Ir Cut切换的稳定时间，表示当曝光量达到某一等级后保持一定的时间，Ir Cut才进行切换，避免亮度突变带来的切换震荡
<span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token operator">:</span> 选择pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> f2k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> r2k
<span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token operator">:</span> 日<span class="token operator">/</span>夜片
返回值<span class="token operator">:</span> 毫秒
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">ir_cut_hold_time_set</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token punctuation">,</span> <span class="token keyword">float</span> hold_time<span class="token punctuation">)</span><span class="token punctuation">;</span>
设置Ir Cut切换的稳定时间，表示当曝光量达到某一等级后保持一定的时间，Ir Cut才进行切换，避免亮度突变带来的切换震荡
<span class="token keyword">enum</span> <span class="token class-name">isp_pipeline_e</span> pipeline<span class="token operator">:</span> 选择pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> f2k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> r2k
<span class="token keyword">enum</span> <span class="token class-name">ir_cut_mode_e</span> ir_cut_mode<span class="token operator">:</span> 日<span class="token operator">/</span>夜片
返回值<span class="token operator">:</span> <span class="token number">0</span>为成功，非<span class="token number">0</span>为失败
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Demo</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;media_ctl.h&quot;</span></span>

ISP_CB_T isp_cb <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span>nIcbId <span class="token operator">=</span> ISP_CALLBACK_ID_IRCUT<span class="token punctuation">,</span> <span class="token comment">// 指定要注册给哪个模块，默认为IRCUT</span>
    <span class="token punctuation">.</span>nSize <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>CB_IR_CUT_T<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 指定回调函数需要的传入参数结构体的长度</span>
    <span class="token punctuation">.</span>pIspfunc <span class="token operator">=</span> test_isp_callback_ircut<span class="token punctuation">,</span> <span class="token comment">// 指定回调函数指针</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 初始化一个回调结构体</span>
<span class="token comment">/*
* 用户测试函数
* @param: void * val , 传给用户约定好的数据类型，在函数内部强转即可
*/</span>
<span class="token keyword">int</span> <span class="token function">test_isp_callback_ircut</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    CB_IR_CUT_T <span class="token operator">*</span> ir_cut_val <span class="token operator">=</span> <span class="token punctuation">(</span>CB_IR_CUT_T <span class="token operator">*</span><span class="token punctuation">)</span>val<span class="token punctuation">;</span> <span class="token comment">// 传入void *强制转换为约定好的数据类型</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;ptr : %p\\n&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印数据地址</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;ircut callback current ctl mode: %d\\n&quot;</span><span class="token punctuation">,</span>ir_cut_val<span class="token operator">-&gt;</span>nIrCutCtl<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印传入的数据</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;ircut callback current sensor: %d\\n&quot;</span><span class="token punctuation">,</span>ir_cut_val<span class="token operator">-&gt;</span>nSensor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印传入的数据</span>
    <span class="token keyword">return</span> <span class="token number">10012</span><span class="token punctuation">;</span> <span class="token comment">// 返回</span>
<span class="token punctuation">}</span>
 
<span class="token comment">/*
* 入口
*/</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">isp_module_callback_register</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>isp_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将初始化的结构体注册</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Day2Night Ev Level: %d\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_ev_get</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取pipeline0的Day2Night Ev Level</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Night2Day Ev Level: %d\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_ev_get</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取pipeline0的Night2Day Ev Level</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Day2Night Ev Level set status: %d\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_ev_set</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置pipeline0的Day2Night Ev Level</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Night2Day Ev Level set status: %d\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_ev_set</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置pipeline0的Night2Day Ev Level</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Day2Night hold time: %f\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_hold_time_get</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Night2Day hold time: %f\\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ir_cut_hold_time_get</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ir_cut_hold_time_set</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ir_cut_hold_time_set</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="api-demo" tabindex="-1"><a class="header-anchor" href="#api-demo" aria-hidden="true">#</a> API_DEMO</h1><p>mediactl_init初始化以及ISP初始化结束后可进行属性页控制功能调用</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token number">1</span>. 初始化默认参数结构体adap_attr_page_r2k
<span class="token number">2</span>. 设置written = <span class="token number">2</span>
<span class="token number">3</span>. 调用attr_page_get_written_stat确认返回值是否为<span class="token number">3</span>，是则继续
<span class="token number">4</span>. 调用attr_page_params_setting，将adap_attr_page_r2k地址传入，等待生效
<span class="token number">5</span>. 修改其他参数，重复步骤<span class="token number">2</span><span class="token number">-4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：避免多个关联模块参数的修改，可能会导致控制异常。如：AE同步，AE手动/自动，曝光和增益范围等。</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">static</span> ADAPTIVE_ATTRIBUTE_PAGE_T adap_attr_page_f2k <span class="token operator">=</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span>nAdaptiveUserAttrEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
    <span class="token punctuation">.</span>nAdaptiveUserAeMode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: sw, 1: hw</span>
    <span class="token punctuation">.</span>nWritten <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>nAeSync <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrIspCtl <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nAeEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAeEnhMode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAwbEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nLdcEnable <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
        <span class="token punctuation">.</span>nLscEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
        <span class="token punctuation">.</span>nFlip <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">// 0: normal, 1: hflip, 2: vflip, 3: hvflip</span>
        <span class="token punctuation">.</span>nAntiflickerScl <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// only sw ae use, 0: normal, 1: 50Hz auto, 2: 50Hz force, 3: 60Hz auto, 4: 60Hz force</span>
        <span class="token punctuation">.</span>nDefogEn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1 &amp; 2: reserved, 3: enable</span>
        <span class="token punctuation">.</span>nWdrEnable <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrLimit <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nCtScl <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: A, 1: U30, 2: U35, 3: TL84, 4: D50, 5: D65</span>
        <span class="token punctuation">.</span>nEtRange <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// [0]: min, [1]: max</span>
        <span class="token punctuation">.</span>nGainRange <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// [0]: min do not modify, [1]: max</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrWeight <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>n2dnrLevelCoeff <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// level 0:10, default 5</span>
        <span class="token punctuation">.</span>nBrightnessCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nContrastCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nSaturationCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nSharpnessCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nAeBacklightCoeff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAeStronglightCoeff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserMenu3A <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nCurExpTime <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurGain <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbRGain <span class="token operator">=</span> <span class="token number">202</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbGGain <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbBGain <span class="token operator">=</span> <span class="token number">356</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> ADAPTIVE_ATTRIBUTE_PAGE_T adap_attr_page_r2k <span class="token operator">=</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span>nAdaptiveUserAttrEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
    <span class="token punctuation">.</span>nAdaptiveUserAeMode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: sw, 1: hw</span>
    <span class="token punctuation">.</span>nWritten <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>nAeSync <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrIspCtl <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nAeEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAeEnhMode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAwbEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nLdcEnable <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
        <span class="token punctuation">.</span>nLscEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1: enable</span>
        <span class="token punctuation">.</span>nFlip <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">// 0: normal, 1: hflip, 2: vflip, 3: hvflip</span>
        <span class="token punctuation">.</span>nAntiflickerScl <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// only sw ae use, 0: normal, 1: 50Hz auto, 2: 50Hz force, 3: 60Hz auto, 4: 60Hz force</span>
        <span class="token punctuation">.</span>nDefogEn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: disable, 1 &amp; 2: reserved, 3: enable</span>
        <span class="token punctuation">.</span>nWdrEnable <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrLimit <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nCtScl <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 0: A, 1: U30, 2: U35, 3: TL84, 4: D50, 5: D65</span>
        <span class="token punctuation">.</span>nEtRange <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// [0]: min, [1]: max</span>
        <span class="token punctuation">.</span>nGainRange <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// [0]: min do not modify, [1]: max</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserAttrWeight <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>n2dnrLevelCoeff <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// level 0:10, default 5</span>
        <span class="token punctuation">.</span>nBrightnessCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nContrastCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nSaturationCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nSharpnessCoeff <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment">// level: 0 - 100, default 50</span>
        <span class="token punctuation">.</span>nAeBacklightCoeff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nAeStronglightCoeff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>tUserMenu3A <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>nCurExpTime <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurGain <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbRGain <span class="token operator">=</span> <span class="token number">202</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbGGain <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>nCurWbBGain <span class="token operator">=</span> <span class="token number">365</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">pthread_t</span> attr_page_daemon<span class="token punctuation">;</span>

<span class="token comment">// 此demo数据同步暂时不完善</span>
<span class="token keyword">int</span> <span class="token function">modify_attr_param</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>adap_attr_page_f2k<span class="token punctuation">.</span>nAdaptiveUserAttrEnable <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            adap_attr_page_f2k<span class="token punctuation">.</span>nAdaptiveUserAttrEnable <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            adap_attr_page_f2k<span class="token punctuation">.</span>nAdaptiveUserAttrEnable <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">attr_page_set</span><span class="token punctuation">(</span><span class="token keyword">int</span> pipeline<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">attr_page_get_written_stat</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">attr_page_params_setting</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> <span class="token operator">&amp;</span>adap_attr_page_f2k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>attr_page_daemon<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> modify_attr_param<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    f2k_pipeline <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">attr_page_set</span><span class="token punctuation">(</span>f2k_pipeline<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,46),c=[t];function o(l,i){return s(),a("div",null,c)}const r=n(p,[["render",o],["__file","03-ISP_User_Property_Page_Guides.html.vue"]]);export{r as default};
